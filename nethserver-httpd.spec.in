Summary: nethserver httpd configuration
Name: nethserver-httpd
Version: @@VERSION@@
Release: @@RELEASE@@
License: GPL
Source: %{name}-%{version}.tar.gz
BuildArch: noarch
URL: %{url_prefix}/%{name} 

BuildRequires: nethserver-devtools >= 1.0.0

AutoReq: no
Requires: nethserver-base >= 1.1.0-2
Requires: httpd, mod_ssl 

%description
NethServer httpd configuration (Apache)

%prep
%setup

%post
source /etc/nethserver/rpm_hook_functions
event_queue add %{name}-update

%preun
source /etc/nethserver/rpm_hook_functions
signal_event %{name}-uninstall

%build
perl createlinks

%install
rm -rf $RPM_BUILD_ROOT
(cd root   ; find . -depth -print | cpio -dump $RPM_BUILD_ROOT)

%{genfilelist} $RPM_BUILD_ROOT > %{name}-%{version}-filelist
echo "%config /etc/httpd/conf/ibays.htpasswd" >> %{name}-%{version}-filelist
echo "%doc COPYING" >> %{name}-%{version}-filelist

%clean 
rm -rf $RPM_BUILD_ROOT

%files -f %{name}-%{version}-filelist
%defattr(-,root,root)

%changelog
* Tue Mar 26 2013 Davide Principi <davide.principi@nethesis.it> - 2.1.0-1.ns6
- httpd.conf template: module fragment is expanded before base fragment. *.conf, *.ibay and *.vhost Include must now check if a module is loaded (IfModule !modname). Refs #1793 
- Bugfixes #1792 #1791

* Tue Mar 19 2013 Davide Principi <davide.principi@nethesis.it> - 2.0.0-1.ns6
- Grant read access to Apache web server by adding Posix ACLs. Refs #1734
- Use certificate management from nethserver-base. Refs #1723
- Migration support. Refs #1690
- Support for virtual hosts and ibays profiles. Refs #1690
- Emit log warnings if some misconfiguration is detected. Refs #1690
- *.spec.in: fixed %files section; use url_prefix macro in URL tag; 
  set minimum version requirements. Refs #1690 #1653 #1654

* Thu Jan 31 2013 Davide Principi <davide.principi@nethesis.it> - 1.0.1-1.ns6
- Implemented nethserver-base certificate management


